<section class="blogs-hero">
  <!-- Background image -->
  <img class="blogs-hero__bg" src="assets/images/blog-hero.svg" alt="" aria-hidden="true" />
  <div class="blogs-hero__overlay"></div>
  
  <!-- Floating decorative shapes -->
  <div class="floating-shape floating-shape--1"></div>
  <div class="floating-shape floating-shape--2"></div>
  <div class="floating-shape floating-shape--3"></div>
  <div class="particle-field">
    <span class="particle"></span>
    <span class="particle"></span>
    <span class="particle"></span>
    <span class="particle"></span>
    <span class="particle"></span>
    <span class="particle"></span>
    <span class="particle"></span>
    <span class="particle"></span>
  </div>

  <div class="blogs-hero__content" appRevealOnScroll>
    <p class="eyebrow animate-text">In an era of artificial substitutes, the truth is your strongest defense.<br>Explore the science for the convincing proofs behind the ICBN Method.</p>
    <h1 class="animate-title">
      <span class="word">SOIL,</span><br>
      <span class="word">SOUL,</span><br>
      <span class="word highlight">&</span> <span class="word highlight">SOVEREIGNTY!</span>
    </h1>
  </div>
</section>

<section class="blogs-featured">
  <div class="blogs-featured__bg"></div>

  <div class="blogs-featured__cards">
    <!-- Loading state -->
    @if (featuredLoading) {
      <div class="card card--large">
        <div class="card__shimmer"></div>
        <div class="card__label">Loading...</div>
      </div>
    }

    <!-- Error state -->
    @if (featuredError && !featuredLoading) {
      <div class="card card--large">
        <div class="card__label">Error</div>
        <h2>Failed to load featured articles</h2>
        <p>Please try again later.</p>
      </div>
    }

    <!-- Featured articles from API -->
    @if (!featuredLoading && !featuredError && featuredArticles.length > 0) {
      <!-- Large card - First Article -->
      <a [routerLink]="['/blogs', featuredArticles[0].id]" class="card card--large" appRevealOnScroll>
        <div class="card__orb"></div>
        <div class="card__label">Featured</div>
        <h2>{{ featuredArticles[0].title }}</h2>
        <p>{{ featuredArticles[0].subtitle }}</p>
        <span class="card__button btn-ripple">Read More</span>
      </a>

      <!-- Small cards for remaining featured articles -->
      @if (featuredArticles.length > 1) {
        <div class="card-column">
          @for (article of featuredArticles.slice(1); track article.id) {
            <a [routerLink]="['/blogs', article.id]" class="card card--small" appRevealOnScroll>
              <div class="card__orb"></div>
              <h3>{{ article.title }}</h3>
              <p>{{ article.subtitle }}</p>
              <span class="card__button btn-ripple">Read More</span>
            </a>
          }
        </div>
      }
    }

    <!-- Fallback if no featured articles -->
    @if (!featuredLoading && !featuredError && featuredArticles.length === 0) {
      <div class="card card--large" appRevealOnScroll>
        <div class="card__orb"></div>
        <div class="card__label">Featured</div>
        <h2>No featured articles available</h2>
        <p>Please check back later.</p>
      </div>
    }
  </div>
</section>

<section class="blogs-explore">
  <div class="pattern-bg"></div>
  
  <!-- Animated background orbs -->
  <div class="orb orb--1"></div>
  <div class="orb orb--2"></div>

  <div class="blogs-explore__inner">
    <h2 class="section-title" appRevealOnScroll>EXPLORE</h2>

    <div class="topic-cards-wrapper">
      <!-- Loading state -->
      @if (loading) {
        <div class="topic-cards-loading">
          <div class="loading-spinner"></div>
          <p>Loading articles...</p>
        </div>
      }

      <!-- Error state -->
      @if (error && !loading) {
        <div class="topic-cards-error">
          <div class="error-icon">☁️</div>
          <h3>Cloudy with a chance of errors</h3>
          <p>We couldn't fetch the articles right now. Give it another shot!</p>
          <button type="button" class="retry-button" (click)="ngOnInit()">Try Again</button>
        </div>
      }

      <!-- Articles loaded -->
      @if (!loading && !error && displayArticles.length > 0) {
        <div class="topic-cards-track">
          @for (article of displayArticles; track $index; let i = $index) {
            <article 
              class="topic-card" 
              [class.topic-card--light]="!article.cover_image && i % 2 === 0"
              [class.topic-card--dark]="!article.cover_image && i % 2 !== 0"
              [class.topic-card--image]="article.cover_image"
              [style.background-image]="article.cover_image ? 'url(' + article.cover_image + ')' : null"
            >
              <h3 [innerHTML]="article.title"></h3>
              <p>{{ article.subtitle }}</p>
              <button
                type="button"
                class="topic-card__button"
                [routerLink]="['/blogs', article.id]"
              >
                Read More
              </button>
            </article>
          }
        </div>
      }

      <!-- No articles -->
      @if (!loading && !error && displayArticles.length === 0) {
        <div class="topic-cards-empty">
          <p>No articles available at the moment.</p>
        </div>
      }
    </div>

    <div class="evidence" appRevealOnScroll>
      <h2 class="section-title glitch-text">THE EVIDENCE ARCHIVE</h2>
      <p class="evidence__subtitle">
        Browse through a database of 20+<br />Peer-Reviewed Studies
      </p>
      <button type="button" class="pill-button pulse-btn" routerLink="/evidence">Clinical Research Papers</button>
    </div>

    <div class="research-card" appRevealOnScroll>
      <div class="research-card__image-placeholder">
        <img src="assets/images/evidence-archive.svg" alt="Evidence Archive" />
        <div class="research-card__shine"></div>
      </div>
      <div class="research-card__content">
        <h3>The Science Behind ICBN:<br />A Database of 20+<br />Peer-Reviewed Studies</h3>
        <a routerLink="/evidence" class="research-card__link hover-arrow">Learn More <span class="arrow">→</span></a>
      </div>
    </div>
  </div>
</section>
